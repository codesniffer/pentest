'use strict';

const util = require('util');

const client = require('shodan-client');

const shodanKey = 'tRLde5KXScaemF7GLU0Ig0Jh6J1p4pFE';

var Exploits = {};



function search (inputs) {

	var searchOpts = {
	  query: 'asterisk',
	  facets: 'port:100',
	  page: 1,
	};

	client.exploits.search('asterisk', shodanKey, searchOpts)
	.then(res => {
	  console.log('Result:');
	  console.log(util.inspect(res, { depth: 6 }));
	})
	.catch(err => {
	  console.log('Error:');
	  console.log(err);
	});
}

Exploits.performAction = function (option, inputs) {

	switch (option) {
		case 'search': 
			search(inputs);
			break;
		default: 
	}
}


module.exports = Exploits;